---
c1: debug
c2: analyze-deep
c3: project-issues
title: プロジェクト全体の深掘り調査と修正タスク洗い出し
description: プロジェクト全体を深く調査し、リファクタ課題や重複コード、修正すべき問題を洗い出し、ドメイン駆動設計からテスト駆動設計への移行を支援する
usage: |
  プロジェクト全体の深掘り調査と修正タスクの洗い出しを実行します。
  既存のissue一覧を確認し、適切な処理を行います。
options:
  input: []
  adaptation: []
  file: [false]
  stdin: [true]
  destination: [false]
---

# 指示:

以下の2点を実施して。

1. プロジェクト全体を深く調査し、リファクタ課題や重複コード、修正すべき問題を洗い出して。具体的には「プロジェクトの深掘り調査」を実行すること。
2. ドメイン駆動設計からテスト駆動設計へ進め、テストが要求や仕様書を反映していない箇所を洗い出して。カバレッジよりも仕様のテスト反映を優先すべき。具体的には「設計の実装調査」を実行すること。

## 強固構築方針

- **ドメイン駆動設計**: ビジネスロジックとドメインモデルを中核とした堅牢な設計
- **全域性原則**:
  型安全性による不正状態の完全排除（`docs/development/totality_go.ja.md`参照）
- **強固性重視**: 障害耐性、保守性、拡張性を重視した堅牢な構築
- [AI複雑化防止（科学的制御）](docs/development/ai-complexity-control_compact.ja.md)
- [ハードコーディング禁止規定](docs/development/prohibit-hardcoding.ja.md)

## 必須参照資料

必ず以下の資料を参照してから強固な設計・実装を開始すること：

1. **ドメイン設計**: `docs/domain/domain_boundary-*.md`
2. **サブドメイン設計**: `docs/domain/architecture/**/*.md`
3. **全域性原則**: `docs/development/totality_go.ja.md`
4. **テスト方針**: `docs/tests/README.md`, `docs/tests/testing_guidelines.md`
5. **ハードコーディング禁止規定**: `docs/development/prohibit-hardcoding.ja.md`


## プロジェクトの深掘り調査

要求が期待するフローを構築:
1. まず「要求」ファイルを読み込む。
2. 「要求」を満たすフローを3パターン考える。開始地点から完了までを網羅すること。
3. ３パターンからランダムに1つ選ぶ（「要求フロー」とする）

要求フローを実行:
4. 「要求フロー」を実現するための実行案を2つ作成する（「要求実行案」とする）
5. 「要求実行案」を2つ実行する
6. 「要求実行案」の2つを比較し、実行結果を得る（「要求実行案の実行結果」とする）

実行結果の比較:
7. 「要求実行案の実行結果」を相互に比較し、処理フローの実行状況を把握する
8. 結果とプロセスの両面に着目し、必要なデバッグ出力を得る
9. プロセスでは、if 文による特殊分岐がハードコーディングされていないか調べる（要求は特殊解でなく抽象度で満たせ。場当たり的実装を禁ず。）

比較した結果の評価:
10. 比較した結果を、当初の「要求」と照らし合わせる
11. 「要求」に対し、比較した結果が、要求を満たすか判定する

## 設計の実装調査

1.要求を特殊解に縛る実装を禁止し、要求を抽象度に即して一般解として設計する

# 課題がある場合

既存のissue一覧を gh で取得し、問題に近いIssueがあるか調べる。
「近いIssueがない場合」と「近いIssueがある場合」に応じて、処理を変え、実施する。

## 近いIssueがない場合:

gh で 適切なラベルをつけてIssueを作って。

- Issueへ完了条件を明記すること。
- Issueへ「経過をコメントへ残す」旨の記述をすること。

### ラベル

[bug, ci-failure, duplicate, enhancement, refactor, documentation,
high-priority]

## 近いIssueがある場合:

gh でIssue内容を変更する。

- 既存Issueの内容と照らし合わせ、修正点を加筆・修正する。
- 完了条件を見直し、必要な条件を追記・削除する。
- ラベルを見直し、変更する。

Issue コメントへ、変更した点を記載する。

# 何も課題がない場合

ひとつも問題がなく、修正も全て完了している場合は、リリースIssueを作成する。

gh で ラベル "release" を含む Issueを作成して。 全部で30行以内に収めること。

Issueへの登録内容:

- Releaseノートに含める文言
- 実装が確認された内容のサマリー
